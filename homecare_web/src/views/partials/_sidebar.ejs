<!--src\views\partials\_sidebar.ejs-->
<%
// Sidebar com controle por papel.
// auth.* vem de res.locals (middleware setViewLocals)
const r = (typeof auth?.role === 'string' ? auth.role : '').toLowerCase();
const isAdmin = !!auth?.isAdmin;
const isAtendente = !!auth?.isAtendente;
const isMedico = !!auth?.isMedico;

// Define a rota de Pacientes de forma dinÃ¢mica por papel
const PACIENTES_PATH = isMedico ? '/pacientes-medico' : '/pacientes';

// Rotas usadas no menu (centraliza aqui se precisar mudar paths)
const ROUTES = {
  dashboard: '/',
  agenda: '/agenda',
  pacientes: PACIENTES_PATH,
  cadastro: '/cadastro',
  relatorio: '/relatorio',
  perfil: '/perfil',
};
%>

<aside id="sidebar" class="sidebar">
  <div class="sidebar__top">
    <a href="<%= ROUTES.dashboard %>" class="brand" aria-label="PÃ¡gina inicial">
      <img src="/img/logo.png" alt="Connect Health" class="brand-logo--lg" />
    </a>
  </div>

  <nav class="menu">
    <!-- Sempre: Dashboard -->
    <a class="menu__item" href="<%= ROUTES.dashboard %>" data-collapse-on-click title="Dashboard">
      <span class="menu__icon">ğŸ </span>
      <span class="menu__text">Dashboard</span>
      <span class="menu__rail">Dashboard</span>
    </a>

    <% if (isAtendente || isMedico) { %>
      <!-- Atendente & MÃ©dico: Agenda -->
      <a class="menu__item" href="<%= ROUTES.agenda %>" data-collapse-on-click title="Agenda">
        <span class="menu__icon">ğŸ—“ï¸</span>
        <span class="menu__text">Agenda</span>
        <span class="menu__rail">Agenda</span>
      </a>

      <!-- Atendente & MÃ©dico: Pacientes (rota dinÃ¢mica por papel) -->
      <a class="menu__item" href="<%= ROUTES.pacientes %>" data-collapse-on-click title="Pacientes">
        <span class="menu__icon">ğŸ‘¥</span>
        <span class="menu__text">Pacientes</span>
        <span class="menu__rail">Pacientes</span>
      </a>
    <% } %>

    <% if (isAdmin) { %>
      <!-- Admin: Cadastro -->
      <a class="menu__item" href="<%= ROUTES.cadastro %>" data-collapse-on-click title="Cadastro">
        <span class="menu__icon">ğŸ§©</span>
        <span class="menu__text">Cadastro</span>
        <span class="menu__rail">Cadastro</span>
      </a>

      <!-- Admin: RelatÃ³rios -->
      <a class="menu__item" href="<%= ROUTES.relatorio %>" data-collapse-on-click title="RelatÃ³rios">
        <span class="menu__icon">ğŸ“Š</span>
        <span class="menu__text">RelatÃ³rios</span>
        <span class="menu__rail">RelatÃ³rios</span>
      </a>
    <% } %>

    <hr class="menu__sep">

    <!-- Sempre: Perfil -->
    <a class="menu__item" href="<%= ROUTES.perfil %>" title="Perfil">
      <span class="menu__icon">âš™ï¸</span>
      <span class="menu__text">Perfil</span>
      <span class="menu__rail">Perfil</span>
    </a>
  </nav>
</aside>
